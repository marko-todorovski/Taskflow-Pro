<div class="profile-container">
  <mat-card class="profile-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon class="profile-icon">account_circle</mat-icon>
        My Profile
      </mat-card-title>
      <mat-card-subtitle>Update your account settings</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="color-picker-section">
        <label>Profile Color</label>
        <div class="color-options">
          <button
            *ngFor="let color of colors"
            type="button"
            class="color-option"
            [style.background-color]="color"
            [class.selected]="selectedColor === color"
            (click)="selectColor(color)"
          >
            <mat-icon *ngIf="selectedColor === color">check</mat-icon>
          </button>
        </div>
        <div class="color-preview">
          <div class="avatar-preview" [style.background-color]="selectedColor">
            {{ currentUser?.displayName?.substring(0, 2)?.toUpperCase() }}
          </div>
          <span>Preview</span>
        </div>
      </div>

      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Display Name</mat-label>
          <input matInput formControlName="displayName" placeholder="Enter your name" />
          <mat-icon matPrefix>badge</mat-icon>
          <mat-error *ngIf="profileForm.get('displayName')?.hasError('required')">
            Name is required
          </mat-error>
          <mat-error *ngIf="profileForm.get('displayName')?.hasError('minlength')">
            Name must be at least 2 characters
          </mat-error>
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" placeholder="Enter your email" type="email" />
          <mat-icon matPrefix>email</mat-icon>
          <mat-error *ngIf="profileForm.get('email')?.hasError('required')">
            Email is required
          </mat-error>
          <mat-error *ngIf="profileForm.get('email')?.hasError('email')">
            Please enter a valid email address
          </mat-error>
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline">
          <mat-label>New Password (leave blank to keep current)</mat-label>
          <input 
            matInput 
            [type]="hidePassword ? 'password' : 'text'" 
            formControlName="password" 
            placeholder="Enter new password"
          />
          <mat-icon matPrefix>lock</mat-icon>
          <button 
            mat-icon-button 
            matSuffix 
            type="button"
            (click)="togglePasswordVisibility()"
          >
            <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          <mat-error *ngIf="profileForm.get('password')?.hasError('minlength')">
            Password must be at least 4 characters
          </mat-error>
        </mat-form-field>

        <div class="form-actions">
          <button 
            type="submit" 
            mat-raised-button 
            color="primary" 
            [disabled]="profileForm.invalid || isLoading"
          >
            <mat-icon>save</mat-icon>
            Save Changes
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
